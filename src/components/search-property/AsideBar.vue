<template>
  <!-- DO NOT DELETE THIS SEEMINGLY USELESS FUNCTION `doNothing`!!!!  -->
  <div class="sidebar-container" @click.stop="doNothing" id="sidebar-container">
    <div class="sidebar" :class="{ closed: !isSidebarOpen }" id="sidebar">
      <nav>
        <ul>
          <li @click="setSearchType(0)" :class="{ 'active-search-type': searchType === 0 }">
            <svg t="1703570222696" class="icon" viewBox="0 0 1048 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="4274" width="23" height="23">
              <path
                d="M855.274009 454.992809c10.32454 35.60257 15.864992 73.237934 15.864992 112.169482 0 222.026384-179.990791 402.017175-402.013184 402.017175-222.037334 0-402.028125-179.990791-402.028125-402.017175 0-222.023416 179.990791-402.017175 402.028125-402.017175 35.479664 0 69.882042 4.603057 102.651449 13.232715l18.059682-51.922341c-38.452822-10.508438-78.926363-16.123901-120.711131-16.123901-252.313333 0-456.841652 204.531389-456.841652 456.830702 0 252.306374 204.528422 456.837661 456.841652 456.837661 252.29829 0 456.83367-204.531389 456.83367-456.837661 0-45.978073-6.799692-90.367181-19.436813-132.223891L855.274009 454.992809zM469.125818 402.700729c8.159835 0 16.178856 0.603576 24.019915 1.751884l18.253506-52.480992c-13.680433-2.672291-27.810529-4.087388-42.273421-4.087388-121.10584 0-219.286142 98.176209-219.286142 219.278058 0 121.109831 98.180302 219.282049 219.286142 219.282049 121.109831 0 219.286142-98.172218 219.286142-219.282049 0-15.445314-1.605953-30.513827-4.64307-45.056643l-52.030305 20.360187c1.213189 8.055964 1.845828 16.302784 1.845828 24.696456 0 90.833831-73.631722 164.457571-164.457571 164.457571-90.82984 0-164.472614-73.62374-164.472614-164.457571C304.653306 476.332451 378.294954 402.700729 469.125818 402.700729zM1035.96232 201.696132 834.587992 201.696132 834.587992 0l-54.820487 55.504089 0 0.23785L633.956198 201.696132l-0.372766 0 0 162.49081L432.567843 565.188543l38.527732 38.516782 201.018616-201.004596L834.587992 402.700729l0-0.213865 0.200885 0.213881 145.983225-145.994175-0.20989-0.196894 0.209868 0L1035.96232 201.696132zM813.7021 347.884233l-125.291204 0L688.410895 222.570026l91.356562-91.363521 0 125.302197 125.311192 0L813.7021 347.884233z"
                p-id="4275"></path>
            </svg>
            {{ $t("kerword_search") }}
          </li>
          <li @click="setSearchType(1)" :class="{ 'active-search-type': searchType === 1 }">
            <svg t="1703570293863" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="6661" width="23" height="23">
              <path
                d="M204.8 236.8A19.2 19.2 0 0 0 185.6 256v614.4c0 10.5984 8.6016 19.2 19.2 19.2h614.4a19.2 19.2 0 0 0 19.2-19.2V256A19.2 19.2 0 0 0 819.2 236.8H204.8z m0-64h614.4c45.9264 0 83.2 37.2736 83.2 83.2v614.4c0 45.9264-37.2736 83.2-83.2 83.2H204.8A83.2 83.2 0 0 1 121.6 870.4V256c0-45.9264 37.2736-83.2 83.2-83.2z"
                p-id="6662"></path>
              <path
                d="M339.2 204.8a32 32 0 1 1-64 0V102.4a32 32 0 1 1 64 0v102.4zM748.8 204.8a32 32 0 1 1-64 0V102.4a32 32 0 1 1 64 0v102.4zM358.4 416a32 32 0 1 1 0-64h307.2a32 32 0 1 1 0 64H358.4zM358.4 595.2a32 32 0 1 1 0-64h307.2a32 32 0 1 1 0 64H358.4zM358.4 774.4a32 32 0 1 1 0-64h307.2a32 32 0 1 1 0 64H358.4z"
                p-id="6663"></path>
            </svg>
            {{ $t("abstract_search") }}
          </li>
          <li @click="setSearchType(2)" :class="{ 'active-search-type': searchType === 2 }">
            <svg t="1703570444453" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="8617" width="23" height="23">
              <path
                d="M947.701961 623.435294l-694.713725 0q-11.043137 0-23.090196 6.023529t-22.588235 18.070588-17.066667 28.611765-6.52549 37.647059 5.521569 39.152941 14.556863 32.12549 22.086275 22.086275 28.109804 8.031373l693.709804 0q-12.047059-12.047059-21.082353-27.105882-8.031373-13.05098-14.556863-31.121569t-6.52549-41.160784q0-26.101961 6.52549-43.168627t14.556863-28.109804q9.035294-12.047059 21.082353-21.082353zM947.701961 897.505882q0 17.066667-22.086275 17.066667l-733.866667 0q-34.133333 0-57.223529-14.054902t-37.647059-38.65098-20.580392-58.729412-6.023529-73.286275l0-582.27451q0-77.301961 41.160784-111.937255t117.458824-34.635294l34.133333 0 68.266667 0 93.364706 0q51.2 0 104.909804-0.501961t104.909804-0.501961l94.368627 0 70.27451 0 35.137255 0q28.109804 0 49.192157 11.545098t35.137255 32.12549 21.584314 48.690196 7.529412 60.235294l0 406.588235q-191.74902 0-345.34902-1.003922l-128.501961 0q-64.25098 0-114.94902-0.501961t-83.827451-0.501961l-37.145098 0q-21.082353 0-41.160784 12.54902t-36.141176 34.133333-26.101961 50.196078-10.039216 59.733333q0 38.14902 10.541176 68.768627t27.607843 51.701961 37.647059 32.627451 40.658824 11.545098l685.678431 0q8.031373 0 14.556863 4.517647t6.52549 14.556863zM515.011765 0l0 388.517647 77.301961-108.423529 76.298039 108.423529 0-388.517647-153.6 0z"
                p-id="8618"></path>
            </svg>
            {{ $t("full_text_search") }}
          </li>
          <li @click="setSearchType(3)" :class="{ 'active-search-type': searchType === 3 }">
            <svg t="1703570516245" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="9706" width="23" height="23">
              <path
                d="M116.181404 133.722146 116.181404 441.133425 201.417293 441.133425 201.417293 133.722146 317.598697 133.722146 317.598697 64 0 64 0 133.722146 116.181404 133.722146ZM412.356282 125.799174 412.356282 64 335.263948 64 335.263948 125.799174 412.356282 125.799174ZM335.263948 168.055021 335.263948 441.133425 412.356282 441.133425 412.356282 168.055021 335.263948 168.055021ZM550.003263 168.055021 550.003263 86.184319 472.91093 86.184319 472.91093 168.055021 426.221206 168.055021 426.221206 218.233837 472.91093 218.233837 472.91093 379.33425C472.91093 393.067469 475.263489 404.159517 479.968678 412.610729 484.673868 421.06194 491.098164 427.576318 499.241762 432.154058 507.385359 436.731797 516.795596 439.812922 527.472757 441.397524 538.149917 442.982126 549.4603 443.774415 561.404242 443.774415 569.004932 443.774415 576.786475 443.598351 584.749103 443.246218 592.711731 442.894084 599.950376 442.189827 606.465253 441.133425L606.465253 383.031637C602.845877 383.735905 599.045588 384.264097 595.064275 384.616231 591.082961 384.968365 586.92074 385.144429 582.577488 385.144429 569.547733 385.144429 560.86136 383.031658 556.518108 378.806052 552.174856 374.580447 550.003263 366.129362 550.003263 353.452545L550.003263 218.233837 606.465253 218.233837 606.465253 168.055021 550.003263 168.055021ZM624.673409 64 624.673409 441.133425 701.765741 441.133425 701.765741 64 624.673409 64ZM930.620557 275.279229 805.209786 275.279229C805.571725 269.997222 806.748006 264.011037 808.738662 257.320495 810.729318 250.629953 814.167674 244.291639 819.05383 238.305364 823.939994 232.31909 830.454771 227.301258 838.598368 223.25172 846.741965 219.20218 856.966547 217.177441 869.272429 217.177441 888.09319 217.177441 902.118061 222.107241 911.347469 231.966988 920.576883 241.826734 927.001178 256.264004 930.620557 275.279229L930.620557 275.279229ZM805.209786 322.817057 1007.71289 322.817057C1009.16064 301.689028 1007.350976 281.441637 1002.283853 262.074278 997.216723 242.706918 988.982765 225.45262 977.581728 210.310867 966.180691 195.169113 951.612922 183.10871 933.877978 174.129299 916.143034 165.149886 895.33193 160.660248 871.444045 160.660248 850.089722 160.660248 830.635866 164.357597 813.081888 171.752407 795.527917 179.147217 780.417248 189.270913 767.749427 202.123796 755.081613 214.97668 745.30944 230.206239 738.432627 247.81293 731.555808 265.41962 728.117453 284.434561 728.117453 304.858322 728.117453 325.986351 731.465325 345.35342 738.161171 362.96011 744.857018 380.566801 754.357741 395.708327 766.663622 408.385144 778.969498 421.061962 793.98969 430.833528 811.724634 437.700138 829.459578 444.566747 849.36585 448 871.444045 448 903.29456 448 930.439475 440.957429 952.87961 426.872077 975.319744 412.786724 991.968627 389.370177 1002.826752 356.621733L934.963782 356.621733C932.430221 365.072945 925.55351 373.083869 914.33344 380.654746 903.113376 388.225622 889.721882 392.011004 874.158566 392.011004 852.442304 392.011004 835.793421 386.553012 824.211418 375.636864 812.629414 364.720716 806.295597 347.114289 805.209786 322.817057ZM0 576 1024 576 1024 640 0 640 0 576ZM0 768 1024 768 1024 832 0 832 0 768ZM0 960 768 960 768 1024 0 1024 0 960Z"
                p-id="9707"></path>
            </svg>
            {{ $t("title_search") }}
          </li>
          <li @click="setSearchType(4)" :class="{ 'active-search-type': searchType === 4 }">
            <svg t="1703570564669" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="10733" width="23" height="23">
              <path
                d="M510.548 105.582c-129.797 0-235.386 105.593-235.386 235.39 0 93.999 55.509 175.067 135.354 212.767-147.613 43.35-255.793 179.825-255.793 341.273 0 10.275 8.327 18.594 18.594 18.594 10.267 0 18.594-8.319 18.594-18.594 0-175.702 142.956-318.65 318.636-318.65 129.797 0 235.395-105.593 235.395-235.39s-105.598-235.39-235.395-235.39z m0 433.591c-109.294 0-198.197-88.917-198.197-198.202 0-109.29 88.903-198.202 198.197-198.202 109.298 0 198.206 88.912 198.206 198.202 0 109.29-88.903 198.202-198.206 198.202z m0 0z m215.838 72.907c-8.175-6.229-19.83-4.686-26.057 3.487-6.245 8.17-4.686 19.826 3.484 26.074 79.681 60.886 125.367 153.241 125.367 253.366 0 10.279 8.332 18.598 18.595 18.598 10.275 0 18.594-8.319 18.594-18.598 0-111.818-51.024-214.941-139.984-282.927z m0 0z"
                p-id="10734"></path>
            </svg>
            {{ $t("author_search") }}
          </li>
          <li @click="setSearchType(5)" :class="{ 'active-search-type': searchType === 5 }">
            <svg t="1703570653244" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="16507" width="23" height="23">
              <path
                d="M682.666667 917.333333H213.333333l-15.146666-6.186666-42.666667-42.666667L149.333333 853.333333V213.333333l6.186667-15.146666 42.666667-42.666667L213.333333 149.333333h469.333334l21.333333 21.333334v725.333333z m-460.586667-42.666666H661.333333V192H222.08L192 222.08v622.506667z"
                p-id="16508"></path>
              <path
                d="M576 320v213.333333h-85.333333V320h85.333333m42.666667-42.666667h-170.666667v298.666667h170.666667V277.333333zM234.666667 704h384v42.666667H234.666667zM234.666667 362.666667h170.666666v42.666666h-170.666666zM725.333333 256h42.666667v597.333333h-42.666667zM234.666667 277.333333h64v42.666667h-64zM234.666667 618.666667h384v42.666666H234.666667zM789.333333 320h42.666667v341.333333h-42.666667zM789.333333 704h42.666667v85.333333h-42.666667zM234.666667 448h170.666666v42.666667h-170.666666zM234.666667 533.333333h170.666666v42.666667h-170.666666z"
                p-id="16509"></path>
            </svg>
            {{ $t("journal_search") }}
          </li>
          <li @click="setSearchType(6)" :class="{ 'active-search-type': searchType === 6 }">
            <svg t="1703571213273" class="icon" viewBox="0 0 1157 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
              p-id="17896" width="23" height="23">
              <path
                d="M0 1024v-60.237913h86.817391V120.475826C86.817391 53.960348 138.640696 0 202.573913 0h405.147826c63.933217 0 115.756522 53.960348 115.756522 120.475826v240.951652h231.513043c63.933217 0 115.756522 53.915826 115.756522 120.475826v481.858783H1157.565217V1024H0zM665.6 120.475826c0-33.302261-25.911652-60.237913-57.878261-60.237913h-405.147826c-31.966609 0-57.878261 26.935652-57.878261 60.237913v843.286261h520.904348V120.475826z m347.269565 361.427478c0-33.302261-25.911652-60.237913-57.878261-60.237913h-231.513043v542.096696h289.391304V481.903304z m-57.878261 150.572522h-173.634782v-60.237913h173.634782v60.237913z m0 180.713739h-173.634782v-60.237913h173.634782v60.237913z m-578.782608-481.903304h-173.634783V271.048348h173.634783v60.237913z m0 180.713739h-173.634783v-60.237913h173.634783V512z m0 180.713739h-173.634783v-60.237913h173.634783v60.237913z m231.513043-361.427478h-173.634782V271.048348h173.634782v60.237913z m0 180.713739h-173.634782v-60.237913h173.634782V512z m0 180.713739h-173.634782v-60.237913h173.634782v60.237913z"
                fill="" p-id="17897"></path>
            </svg>
            {{ $t("institution_search") }}
          </li>
          <li @click="advancedSearch">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512"
              style="">
              <path
                d="M256 64C150.13 64 64 150.13 64 256s86.13 192 192 192s192-86.13 192-192S361.87 64 256 64zm80 294.63l-54.15-54.15a88.08 88.08 0 1 1 22.63-22.63L358.63 336z"
                fill="currentColor"></path>
              <circle cx="232" cy="232" r="56" fill="currentColor"></circle>
            </svg>
            {{ $t("advanced_search_text") }}
          </li>
        </ul>
      </nav>
    </div>

    <div class="toggle-button" @click.stop="toggleSidebar" v-if="!isSidebarOpen && toggleShouldShow">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon">
        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="48"
          d="M88 152h336"></path>
        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="48"
          d="M88 256h336"></path>
        <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="48"
          d="M88 360h336"></path>
      </svg>
    </div>

    <AdvancedSearchModal :show="is_advanced_search" @senddata="advsearch" @close="is_advanced_search = false">
    </AdvancedSearchModal>
  </div>
</template>
  
<script>
import AdvancedSearchModal from "../../components/modals/AdvancedSearchModal.vue";
import i18n from "../../language";
export default {
  components: {
    AdvancedSearchModal,
    i18n,
  },
  data() {
    return {
      is_advanced_search: false,
      isSidebarOpen: false,
      toggleShouldShow: true,
      searchType: 0,
      dropdownOptions: ["选项1", "选项2", "选项3"], // 下拉列表的选项
      selectedOption: "", // 选中的选项
    };
  },
  watch: {
    isSidebarOpen: {
      handler(newValue, oldValue) {
        this.$nextTick(() => {
          if (newValue == true) {
            document.getElementById("sidebar-container").style.width = "250px";
            document.getElementById("sidebar").style.width = "250px";
          } else {
            setTimeout(() => {
              document.getElementById("sidebar-container").style.width = "0px";
              document.getElementById("sidebar").style.width = "0px";
            }, 310);
          }
        });
      },
      immediate: true,
    },
  },

  mounted() {
    window.addEventListener("click", this.closeSidebar);
  },
  beforeUnmount() {
    window.removeEventListener("click", this.closeSidebar);
  },

  methods: {
    toggleSidebar() {
      this.isSidebarOpen = !this.isSidebarOpen;
      this.toggleShouldShow = false;
    },

    closeSidebar() {
      if (this.isSidebarOpen) {
        this.isSidebarOpen = false;
        setTimeout(() => {
          this.toggleShouldShow = true;
        }, 310);
      }
    },

    advancedSearch() {
      this.is_advanced_search = true;
    },

    setSearchType(type) {
      this.$emit("setSearchType", type);
      this.searchType = type
      this.closeSidebar();
    },
    advsearch(data) {
      this.$emit("advsearch", data);
      // alert("data send to aside bar");
    },
    doNothing() {
      /* DO NOT DELETE THIS !!!!!!!! */
    },
  },
};
</script>
  
<style scoped>
.sidebar-container {
  position: fixed;
  top: 60px;
  left: 0;
  width: 250px;
  height: calc(100vh - 60px);
  z-index: 90;
  /* overflow: hidden; */
}

.sidebar {
  width: 250px;
  color: var(--theme-mode-high-contrast);
  transition: transform 0.3s ease-in-out;
  position: absolute;
  top: 0;
  bottom: 0;
  overflow-y: auto;
  background: var(--theme-mode-like);
  border-radius: 0 20px 20px 0;
}

#sidebar::-webkit-scrollbar {
  display: none !important;
}

#sidebar-container::-webkit-scrollbar {
  display: none !important;
}

.sidebar nav ul .active-search-type {
  background: var(--theme-color);
  color: var(--theme-mode);
  transition: all ease-in-out 0.3s;
}

.sidebar nav ul .active-search-type svg {
  fill: var(--theme-mode);
  transition: all ease-in-out 0.3s;
}

.sidebar nav ul .active-search-type:hover {
  background: var(--theme-color);
  color: var(--theme-mode);
  opacity: 0.8;
}



.sidebar nav ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.sidebar nav ul li {
  padding: 10px 15px;
  border-bottom: 1px solid #ddd;
  /* 条目之间的分隔线 */
  cursor: pointer;
  display: flex;
  align-items: center;
  font-family: Arial, sans-serif;
}

.sidebar nav ul li svg {
  margin: 0;
  margin-right: 10px;
  width: 40px;
  height: 40px;
  fill: var(--default-text-color)
}

.sidebar nav ul li:hover {
  background-color: var(--theme-mode-slight-contrast);
  /* 鼠标悬停的背景色 */
}

.sidebar.closed {
  transform: translateX(-100%);
}

.toggle-button {
  position: absolute;
  top: 0px;
  left: 250px;
  /* transform: translateY(-50%);  */
  background: none;
  border: none;
  cursor: pointer;
  padding: 10px;
  z-index: 100;
  transition: transform 0.3s ease-in-out;
}

.toggle-button .icon {
  fill: none;
  stroke: currentColor;
  stroke-linecap: round;
  stroke-miterlimit: 10;
  stroke-width: 48;
  height: 32px;
  /* 设置 SVG 图标的高度 */
  width: 32px;
  /* 设置 SVG 图标的宽度 */
}

.closed~.toggle-button {
  transform: translateX(-250px);
}

*::-webkit-scrollbar {
  display: none !important;
}</style>
  